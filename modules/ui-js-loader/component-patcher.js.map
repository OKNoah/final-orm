{"version":3,"sources":["component-patcher.es6"],"names":[],"mappings":"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","file":"component-patcher.js","sourcesContent":["import Component from 'ui-js/core/component'\r\n\r\n\r\nexport default class ComponentPatcher {\r\n\r\n\tstatic allWrappers = []\r\n\r\n\r\n\tstatic test(target) {\r\n\t\tif (!target) return false\r\n\t\treturn ('selector' in target) || ('template' in target)\r\n\t}\r\n\r\n\r\n\tstatic patch(Class, module) {\r\n\t\t// try {\r\n\t\tif (module.hot.data) {\r\n\t\t\tvar Wrapper = module.hot.data.wrapper\r\n\t\t} else {\r\n\t\t\tvar Wrapper = this.createWrapper(Class.name)\r\n\t\t}\r\n\r\n\t\tmodule.hot.dispose(data => data.wrapper = Wrapper)\r\n\t\tmodule.hot.accept()\r\n\r\n\t\tWrapper.__setClass(Class)\r\n\t\t// }\r\n\t\t// catch (e) {\r\n\t\t// \tconsole.error(e)\r\n\t\t// }\r\n\r\n\t\treturn Wrapper\r\n\t}\r\n\r\n\r\n\tstatic createWrapper(name) {\r\n\r\n\t\t// to save original name\r\n\t\tlet Wrapper = eval(`(function ${name} () {\r\n\t\t\treturn ${name}.__activeClass.apply(this, arguments) \r\n\t\t})`)\r\n\r\n\t\tthis.allWrappers.push(Wrapper)\r\n\r\n\t\tWrapper.__inited = false\r\n\t\tWrapper.__oldStyle = null\r\n\t\tWrapper.__oldTemplate = null\r\n\t\tWrapper.__oldLogic = null\r\n\t\tWrapper.__activeClass = null\r\n\t\tWrapper.__oldActiveClass = null\r\n\t\tWrapper.__oldComponents = null\r\n\t\tWrapper.__oldTag = null\r\n\r\n\r\n\t\tWrapper.toString = function () {\r\n\t\t\tif (this.__activeClass) {\r\n\t\t\t\treturn this.__activeClass.toString()\r\n\t\t\t}\r\n\t\t\treturn ''\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__setClass = function (Class) {\r\n\t\t\tthis.__oldActiveClass = this.__activeClass\r\n\t\t\tthis.__activeClass = Class\r\n\r\n\t\t\t// TODO check directives\r\n\t\t\tlet templateHasDiff = this.__checkTemplate(Class)\r\n\t\t\tlet componentsHasDiff = this.__checkComponents(Class)\r\n\t\t\tlet styleHasDiff = this.__checkStyle(Class)\r\n\t\t\tlet logicHasDiff = this.__checkLogic(Class)\r\n\t\t\tlet tagHasDiff = this.__checkTag(Class)\r\n\r\n\r\n\t\t\tlet inherits = this.__getInherits()\r\n\t\t\tthis.__copyPropsFrom(Class, inherits)\r\n\r\n\t\t\tif (this.__inited) {\r\n\r\n\t\t\t\tif (tagHasDiff) {\r\n\t\t\t\t\tthrow new Error('Page reload, cuz tag was changed')\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (logicHasDiff || componentsHasDiff) {\r\n\t\t\t\t\tthis.__reload(inherits)\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (styleHasDiff) this.__reloadStyle(inherits)\r\n\t\t\t\t\tif (templateHasDiff) this.__reloadTemplate(inherits)\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.__inited = true\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__reload = function (inherits) {\r\n\t\t\tthis.reload()\r\n\t\t\tfor (let inherit of inherits) inherit.reload()\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__reloadTemplate = function (inherits) {\r\n\t\t\tthis.reloadTemplate()\r\n\t\t\tfor (let inherit of inherits) inherit.reloadTemplate()\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__reloadStyle = function (inherits) {\r\n\t\t\tthis.reloadStyle()\r\n\t\t\tfor (let inherit of inherits) inherit.reloadStyle()\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__getInherits = function (SuperWrapper = this, inherits = []) {\r\n\t\t\tfor (let Wrapper of ComponentPatcher.allWrappers) {\r\n\t\t\t\tif (this.__isInherit(Wrapper, SuperWrapper)) {\r\n\t\t\t\t\tif (inherits.indexOf(Wrapper) === -1) {\r\n\t\t\t\t\t\tinherits.push(Wrapper)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__getInherits(Wrapper, inherits)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn inherits\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__isInherit = function (Wrapper, SuperWrapper) {\r\n\t\t\tlet prototype = Object.getPrototypeOf(Wrapper.prototype)\r\n\t\t\twhile (prototype) {\r\n\t\t\t\tif (prototype.constructor === SuperWrapper) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\tprototype = Object.getPrototypeOf(prototype)\r\n\t\t\t}\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__copyPropsFrom = function (Class, inherits) {\r\n\t\t\tlet oldTemplate = this.template\r\n\t\t\tlet oldPrototype = this.prototype\r\n\r\n\t\t\tlet prototype = Object.getPrototypeOf(Class)\r\n\t\t\tif (Object.setPrototypeOf) Object.setPrototypeOf(this, prototype)\r\n\t\t\telse this.__proto__ = prototype\r\n\r\n\t\t\tlet newProps = Object.getOwnPropertyNames(Class)\r\n\t\t\tfor (let prop of newProps) {\r\n\t\t\t\tlet descriptor = Object.getOwnPropertyDescriptor(Class, prop)\r\n\t\t\t\tObject.defineProperty(this, prop, descriptor)\r\n\t\t\t}\r\n\t\t\tthis.prototype.constructor = this\r\n\r\n\t\t\tComponent.extend(this)\r\n\r\n\t\t\tif (this.__inited) {\r\n\t\t\t\tlet removedProps = this.__getRemovedProps(newProps)\r\n\t\t\t\tfor (let removedProp of removedProps) {\r\n\t\t\t\t\tdelete this[removedProp]\r\n\t\t\t\t}\r\n\t\t\t\tthis.__copyPropsToInherits(inherits, oldTemplate, oldPrototype)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__getRemovedProps = function (newProps) {\r\n\t\t\tlet currentProps = Object.getOwnPropertyNames(this.__oldActiveClass)\r\n\t\t\treturn currentProps.filter(prop => newProps.indexOf(prop) === -1)\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__copyPropsToInherits = function (inherits, oldTemplate, oldPrototype) {\r\n\t\t\tfor (let inherit of inherits) {\r\n\t\t\t\t// template\r\n\t\t\t\tif (inherit.template === oldTemplate) {\r\n\t\t\t\t\tinherit.template = this.template\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// logic\r\n\t\t\t\tlet context = inherit.prototype\r\n\t\t\t\twhile (context) {\r\n\t\t\t\t\tlet chainPrototype = Object.getPrototypeOf(context)\r\n\t\t\t\t\tif (chainPrototype === oldPrototype) {\r\n\t\t\t\t\t\tif (Object.setPrototypeOf) {\r\n\t\t\t\t\t\t\tObject.setPrototypeOf(context, this.prototype)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcontext.__proto__ = this.prototype\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontext = chainPrototype\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__checkTemplate = function (Class) {\r\n\t\t\tlet template = Class.template + ''\r\n\t\t\tlet hasDiff = this.__oldTemplate !== template\r\n\t\t\tthis.__oldTemplate = template\r\n\t\t\treturn hasDiff\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__checkStyle = function (Class) {\r\n\t\t\tlet style = Class.style + ''\r\n\t\t\tlet hasDiff = this.__oldStyle !== style\r\n\t\t\tthis.__oldStyle = style\r\n\t\t\treturn hasDiff\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__checkLogic = function (Class) {\r\n\t\t\tlet logic = this.__getLogic(Class)\r\n\t\t\tlet hasDiff = this.__oldLogic !== logic\r\n\t\t\tthis.__oldLogic = logic\r\n\t\t\treturn hasDiff\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__checkComponents = function (Class) {\r\n\t\t\tlet components = Class.components || []\r\n\t\t\tlet oldComponents = this.__oldComponents || []\r\n\t\t\tlet hasDiff = this.__componentsHasDiff(components, oldComponents)\r\n\t\t\tthis.__oldComponents = components.slice()\r\n\t\t\treturn hasDiff\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__componentsHasDiff = function (components, oldComponents) {\r\n\t\t\tif (components.length !== oldComponents.length) {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\treturn components.some((component, index)=> {\r\n\t\t\t\treturn oldComponents[index] !== component\r\n\t\t\t})\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__checkTag = function (Class) {\r\n\t\t\tlet tag = Class.tag\r\n\t\t\tlet hasDiff = this.__oldTag !== tag\r\n\t\t\tthis.__oldTag = tag\r\n\t\t\treturn hasDiff\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__getLogic = function (Class) {\r\n\t\t\tlet code = ''\r\n\r\n\t\t\tfor (let prop of Object.getOwnPropertyNames(Class)) {\r\n\t\t\t\tif (prop === 'template' || prop === 'style') continue\r\n\t\t\t\tlet descriptor = Object.getOwnPropertyDescriptor(Class, prop)\r\n\t\t\t\tcode += this.__getDescriptorCode(descriptor)\r\n\t\t\t}\r\n\r\n\t\t\tfor (let prop of Object.getOwnPropertyNames(Class.prototype)) {\r\n\t\t\t\tlet descriptor = Object.getOwnPropertyDescriptor(Class.prototype, prop)\r\n\t\t\t\tcode += this.__getDescriptorCode(descriptor)\r\n\t\t\t}\r\n\r\n\t\t\treturn code\r\n\t\t}\r\n\r\n\r\n\t\tWrapper.__getDescriptorCode = function (descriptor) {\r\n\t\t\tif (descriptor.hasOwnProperty('value')) {\r\n\t\t\t\tlet value = descriptor.value\r\n\r\n\t\t\t\tif (typeof value === 'function') {\r\n\t\t\t\t\treturn '' + descriptor.value\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn JSON.stringify(value)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn '' + descriptor.get + descriptor.set\r\n\t\t}\r\n\r\n\r\n\t\treturn Wrapper\r\n\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n"]}