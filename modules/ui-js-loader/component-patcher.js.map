{"version":3,"sources":["component-patcher.es6"],"names":[],"mappings":"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","file":"component-patcher.js","sourcesContent":["import Component from 'ui-js/core/component'\r\n\r\n\r\nexport default class ComponentPatcher {\r\n\r\n\tstatic allWrappers = []\r\n\r\n\r\n\tstatic test(target) {\r\n\t\tif (!target) return false\r\n\t\treturn ('selector' in target) || ('template' in target)\r\n\t}\r\n\r\n\r\n\tstatic patch(Class, module) {\r\n\t\t// try {\r\n\t\tif (module.hot.data) {\r\n\t\t\tvar Wrapper = module.hot.data.wrapper\r\n\t\t} else {\r\n\t\t\tvar Wrapper = this.createWrapper()\r\n\t\t}\r\n\r\n\t\tmodule.hot.dispose(data => data.wrapper = Wrapper)\r\n\t\tmodule.hot.accept()\r\n\r\n\t\tWrapper.__setClass(Class)\r\n\t\t// }\r\n\t\t// catch (e) {\r\n\t\t// \tconsole.error(e)\r\n\t\t// }\r\n\r\n\t\treturn Wrapper\r\n\t}\r\n\r\n\r\n\tstatic createWrapper() {\r\n\t\tvar Wrapper = this.createWrapperClass()\r\n\t\tthis.allWrappers.push(Wrapper)\r\n\t\treturn Wrapper\r\n\t}\r\n\r\n\r\n\tstatic createWrapperClass() {\r\n\r\n\r\n\t\treturn class Wrapper {\r\n\r\n\t\t\tconstructor() {\r\n\t\t\t\treturn Wrapper.__activeClass.apply(this, arguments)\r\n\t\t\t}\r\n\r\n\t\t\tstatic __inited = false\r\n\t\t\tstatic __oldStyle = null\r\n\t\t\tstatic __oldTemplate = null\r\n\t\t\tstatic __oldLogic = null\r\n\t\t\tstatic __activeClass = null\r\n\t\t\tstatic __oldActiveClass = null\r\n\t\t\tstatic __oldComponents = null\r\n\t\t\tstatic __oldTag = null\r\n\r\n\r\n\t\t\tstatic __setClass(Class) {\r\n\t\t\t\tthis.__oldActiveClass = this.__activeClass\r\n\t\t\t\tthis.__activeClass = Class\r\n\r\n\t\t\t\t// TODO check directives\r\n\t\t\t\tlet templateHasDiff = this.__checkTemplate(Class)\r\n\t\t\t\tlet componentsHasDiff = this.__checkComponents(Class)\r\n\t\t\t\tlet styleHasDiff = this.__checkStyle(Class)\r\n\t\t\t\tlet logicHasDiff = this.__checkLogic(Class)\r\n\t\t\t\tlet tagHasDiff = this.__checkTag(Class)\r\n\r\n\r\n\t\t\t\tlet inherits = this.__getInherits()\r\n\t\t\t\tthis.__copyPropsFrom(Class, inherits)\r\n\r\n\t\t\t\tif (this.__inited) {\r\n\r\n\t\t\t\t\tif (tagHasDiff) {\r\n\t\t\t\t\t\tthrow new Error('Page reload, cuz tag was changed')\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (logicHasDiff || componentsHasDiff) {\r\n\t\t\t\t\t\tthis.__reload(inherits)\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (styleHasDiff) this.__reloadStyle(inherits)\r\n\t\t\t\t\t\tif (templateHasDiff) this.__reloadTemplate(inherits)\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.__inited = true\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __reload(inherits) {\r\n\t\t\t\tthis.reload()\r\n\t\t\t\tfor (let inherit of inherits) inherit.reload()\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __reloadTemplate(inherits) {\r\n\t\t\t\tthis.reloadTemplate()\r\n\t\t\t\tfor (let inherit of inherits) inherit.reloadTemplate()\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __reloadStyle(inherits) {\r\n\t\t\t\tthis.reloadStyle()\r\n\t\t\t\tfor (let inherit of inherits) inherit.reloadStyle()\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __getInherits(SuperWrapper = this, inherits = []) {\r\n\t\t\t\tfor (let Wrapper of ComponentPatcher.allWrappers) {\r\n\t\t\t\t\tif (this.__isInherit(Wrapper, SuperWrapper)) {\r\n\t\t\t\t\t\tif (inherits.indexOf(Wrapper) === -1) {\r\n\t\t\t\t\t\t\tinherits.push(Wrapper)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.__getInherits(Wrapper, inherits)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn inherits\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __isInherit(Wrapper, SuperWrapper) {\r\n\t\t\t\tlet prototype = Object.getPrototypeOf(Wrapper.prototype)\r\n\t\t\t\twhile (prototype) {\r\n\t\t\t\t\tif (prototype.constructor === SuperWrapper) {\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprototype = Object.getPrototypeOf(prototype)\r\n\t\t\t\t}\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __copyPropsFrom(Class, inherits) {\r\n\t\t\t\tlet oldTemplate = this.template\r\n\t\t\t\tlet oldPrototype = this.prototype\r\n\r\n\t\t\t\tlet prototype = Object.getPrototypeOf(Class)\r\n\t\t\t\tif (Object.setPrototypeOf) Object.setPrototypeOf(this, prototype)\r\n\t\t\t\telse this.__proto__ = prototype\r\n\r\n\t\t\t\tlet newProps = Object.getOwnPropertyNames(Class)\r\n\t\t\t\tfor (let prop of newProps) {\r\n\t\t\t\t\tlet descriptor = Object.getOwnPropertyDescriptor(Class, prop)\r\n\t\t\t\t\tObject.defineProperty(this, prop, descriptor)\r\n\t\t\t\t}\r\n\t\t\t\tthis.prototype.constructor = this\r\n\r\n\t\t\t\tComponent.extend(this)\r\n\r\n\t\t\t\tif (this.__inited) {\r\n\t\t\t\t\tlet removedProps = this.__getRemovedProps(newProps)\r\n\t\t\t\t\tfor (let removedProp of removedProps) {\r\n\t\t\t\t\t\tdelete this[removedProp]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__copyPropsToInherits(inherits, oldTemplate, oldPrototype)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __getRemovedProps(newProps) {\r\n\t\t\t\tlet currentProps = Object.getOwnPropertyNames(this.__oldActiveClass)\r\n\t\t\t\treturn currentProps.filter(prop => newProps.indexOf(prop) === -1)\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __copyPropsToInherits(inherits, oldTemplate, oldPrototype) {\r\n\t\t\t\tfor (let inherit of inherits) {\r\n\t\t\t\t\t// template\r\n\t\t\t\t\tif (inherit.template === oldTemplate) {\r\n\t\t\t\t\t\tinherit.template = this.template\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// logic\r\n\t\t\t\t\tlet context = inherit.prototype\r\n\t\t\t\t\twhile (context) {\r\n\t\t\t\t\t\tlet chainPrototype = Object.getPrototypeOf(context)\r\n\t\t\t\t\t\tif (chainPrototype === oldPrototype) {\r\n\t\t\t\t\t\t\tif (Object.setPrototypeOf) {\r\n\t\t\t\t\t\t\t\tObject.setPrototypeOf(context, this.prototype)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tcontext.__proto__ = this.prototype\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcontext = chainPrototype\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __checkTemplate(Class) {\r\n\t\t\t\tlet template = Class.template + ''\r\n\t\t\t\tlet hasDiff = this.__oldTemplate !== template\r\n\t\t\t\tthis.__oldTemplate = template\r\n\t\t\t\treturn hasDiff\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __checkStyle(Class) {\r\n\t\t\t\tlet style = Class.style + ''\r\n\t\t\t\tlet hasDiff = this.__oldStyle !== style\r\n\t\t\t\tthis.__oldStyle = style\r\n\t\t\t\treturn hasDiff\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __checkLogic(Class) {\r\n\t\t\t\tlet logic = this.__getLogic(Class)\r\n\t\t\t\tlet hasDiff = this.__oldLogic !== logic\r\n\t\t\t\tthis.__oldLogic = logic\r\n\t\t\t\treturn hasDiff\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __checkComponents(Class) {\r\n\t\t\t\tlet components = Class.components || []\r\n\t\t\t\tlet oldComponents = this.__oldComponents || []\r\n\t\t\t\tlet hasDiff = this.__componentsHasDiff(components, oldComponents)\r\n\t\t\t\tthis.__oldComponents = components.slice()\r\n\t\t\t\treturn hasDiff\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __componentsHasDiff(components, oldComponents) {\r\n\t\t\t\tif (components.length !== oldComponents.length) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t}\r\n\t\t\t\treturn components.some((component, index)=> {\r\n\t\t\t\t\treturn oldComponents[index] !== component\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __checkTag(Class) {\r\n\t\t\t\tlet tag = Class.tag\r\n\t\t\t\tlet hasDiff = this.__oldTag !== tag\r\n\t\t\t\tthis.__oldTag = tag\r\n\t\t\t\treturn hasDiff\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __getLogic(Class) {\r\n\t\t\t\tlet code = ''\r\n\r\n\t\t\t\tfor (let prop of Object.getOwnPropertyNames(Class)) {\r\n\t\t\t\t\tif (prop === 'template' || prop === 'style') continue\r\n\t\t\t\t\tlet descriptor = Object.getOwnPropertyDescriptor(Class, prop)\r\n\t\t\t\t\tcode += this.__getDescriptorCode(descriptor)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (let prop of Object.getOwnPropertyNames(Class.prototype)) {\r\n\t\t\t\t\tlet descriptor = Object.getOwnPropertyDescriptor(Class.prototype, prop)\r\n\t\t\t\t\tcode += this.__getDescriptorCode(descriptor)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn code\r\n\t\t\t}\r\n\r\n\r\n\t\t\tstatic __getDescriptorCode(descriptor) {\r\n\t\t\t\tif (descriptor.hasOwnProperty('value')) {\r\n\t\t\t\t\tlet value = descriptor.value\r\n\r\n\t\t\t\t\tif (typeof value === 'function') {\r\n\t\t\t\t\t\treturn '' + descriptor.value\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\treturn JSON.stringify(value)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn '' + descriptor.get + descriptor.set\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n"]}