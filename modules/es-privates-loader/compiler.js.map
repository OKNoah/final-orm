{"version":3,"sources":["compiler.es6"],"names":[],"mappings":";;;;;kBAMwB,Q;AANxB,IAAI,sBAAsB,sBAA1B;AACA,IAAI,oBAAoB,mBAAxB;AACA,IAAI,gBAAc,KAAK,MAAL,GAAc,QAAd,GAAyB,KAAzB,CAA+B,CAA/B,CAAd,QAAJ;AACA,IAAI,cAAc,IAAI,MAAJ,CAAW,KAAX,EAAkB,KAAlB,CAAlB;;AAGe,SAAS,QAAT,CAAkB,IAAlB,EAAwB;AACtC,KAAI,CAAC,IAAL,EAAW,OAAO,IAAP;;;AAGX,KAAI,WAAW,EAAf;AACA,QAAO,KAAK,OAAL,CAAa,mBAAb,EAAkC,UAAC,OAAD,EAAY;AACpD,WAAS,IAAT,CAAc,OAAd;AACA,SAAO,KAAP;AACA,EAHM,CAAP;;;AAMA,KAAI,QAAQ,EAAZ;AACA,QAAO,KAAK,OAAL,CAAa,iBAAb,EAAgC,UAAC,KAAD,EAAQ,IAAR,EAAgB;AACtD,MAAI,MAAM,OAAN,CAAc,IAAd,MAAwB,CAAC,CAA7B,EAAgC;AAC/B,SAAM,IAAN,CAAW,IAAX;AACA;AACD,iBAAa,IAAb;AACA,EALM,CAAP;;;AAQA,QAAO,KAAK,OAAL,CAAa,WAAb,EAA0B;AAAA,SAAK,SAAS,KAAT,EAAL;AAAA,EAA1B,CAAP;;;AAGA,KAAI,cAAc,MAAM,GAAN,CAAU,gBAAQ;AACnC,oBAAgB,IAAhB,sBAAoC,IAApC;AACA,EAFiB,EAEf,IAFe,CAEV,IAFU,CAAlB;;AAIA,KAAI,CAAC,WAAL,EAAkB,OAAO,IAAP;AAClB,QAAU,WAAV,YAA4B,IAA5B;AACA","file":"compiler.js","sourcesContent":["let stringLiteralRegExp = /(['\"`])[\\s\\S]*?\\1/img\r\nlet privatePropRegExp = /\\b\\.?_([\\w$]+)/img\r\nlet label = `###${Math.random().toString().slice(2)}###`\r\nlet labelRegExp = new RegExp(label, 'img')\r\n\r\n\r\nexport default function compiler(code) {\r\n\tif (!code) return code\r\n\r\n\t// save literals\r\n\tlet literals = []\r\n\tcode = code.replace(stringLiteralRegExp, (literal)=> {\r\n\t\tliterals.push(literal)\r\n\t\treturn label\r\n\t})\r\n\r\n\t// transform code\r\n\tlet props = []\r\n\tcode = code.replace(privatePropRegExp, (match, prop)=> {\r\n\t\tif (props.indexOf(prop) === -1) {\r\n\t\t\tprops.push(prop)\r\n\t\t}\r\n\t\treturn `[$$${prop}$$]`\r\n\t})\r\n\r\n\t// restore literals\r\n\tcode = code.replace(labelRegExp, ()=> literals.shift())\r\n\r\n\t// add prop symbols in head\r\n\tlet symbolsInit = props.map(prop => {\r\n\t\treturn `var $$${prop}$$ = Symbol('${prop}');`\r\n\t}).join('\\n')\r\n\r\n\tif (!symbolsInit) return code\r\n\treturn `${symbolsInit}\\n\\n${code}`\r\n}\r\n\r\n"]}