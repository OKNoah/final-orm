{"version":3,"sources":["field-type.es6"],"names":[],"mappings":";;;;;;;;;AAAA;;;;;;;;;;;;IAGqB,S;;;AAGpB,oBAAY,QAAZ,EAAsB,IAAtB,EAA4B,IAA5B,EAAkC,OAAlC,EAA6D;AAAA,MAAlB,QAAkB,yDAAP,KAAO;;AAAA;;AAAA,2FACtD,QADsD,EAC5C,IAD4C,EACtC,OADsC,EAC7B,QAD6B;;AAE5D,QAAK,IAAL,GAAY,IAAZ;AACA,QAAK,SAAL,CAAe,IAAf;AAH4D;AAI5D;;;;4BAGS,I,EAAM;AACf,OAAI,SAAS,OAAb,EAAsB;AACtB,OAAI,SAAS,MAAb,EAAqB;AACrB,OAAI,SAAS,MAAb,EAAqB;AACrB,OAAI,SAAS,IAAb,EAAmB;;AAEnB,OAAI,CAAC,KAAK,SAAL,CAAe,MAApB,EAA4B;AAC3B,UAAM,uBAAqB,KAAK,IAA1B,gCAAN;AACA;;AAED,OAAI,CAAC,KAAK,QAAV,EAAoB;AACnB,UAAM,uBAAqB,KAAK,IAA1B,+CAAsE,KAAK,IAA3E,yBAAN;AACA;AACD;;;2BAGQ,I,EAAM,Q,EAAU;AACxB,OAAI,KAAK,QAAT,EAAmB;;AAEnB,OAAI,QAAQ,KAAK,SAAL,CAAe,IAAf,CAAZ;AACA,OAAI,CAAC,KAAK,aAAL,CAAmB,KAAnB,EAA0B,QAA1B,CAAL,EAA0C;AACzC,SAAK,SAAL,CAAe,KAAK,IAApB,EAA0B,KAA1B;AACA;AACD;;;gCAGa,K,EAAO,Q,EAAU;AAC9B,OAAI,OAAO,KAAK,IAAhB;;AAEA,WAAQ,IAAR;AACC,SAAK,MAAL;AACC,YAAO,OAAO,KAAP,KAAiB,QAAxB;AACD,SAAK,MAAL;AACC,YAAO,KAAK,cAAL,CAAoB,KAApB,EAA2B,QAA3B,CAAP;AACD,SAAK,OAAL;AACC,YAAO,OAAO,KAAP,KAAiB,SAAxB;AACD;AACC,YAAO,iBAAiB,IAAxB;AARF;AAWA;;;iCAGc,K,EAAO,Q,EAAU;AAC/B,OAAI,OAAO,KAAP,KAAiB,QAArB,EAA+B,OAAO,KAAP;AAC/B,OAAI,UAAU,KAAK,OAAnB;;AAGA,OAAI,SAAS,OAAb,EAAsB,IAAI,QAAQ,QAAQ,GAApB,EAAyB;AAC9C,YAAQ,GAAR,CAAY,qBAAZ;;AAEA;;AAED,UAAO,IAAP;AACA;;;sCAGmB,K,EAAO;AAC1B,OAAI,SAAS,IAAb,EAAmB,OAAO,KAAP;AACnB,OAAI,OAAO,KAAK,IAAhB;;AAEA,WAAQ,IAAR;AACC,SAAK,MAAL;AACC,YAAO,OAAO,KAAP,CAAP;AACD,SAAK,MAAL;AACC,YAAO,OAAO,KAAP,CAAP;AACD,SAAK,OAAL;AACC,YAAO,QAAQ,KAAR,CAAP;AACD,SAAK,IAAL;AACC,YAAO,IAAI,IAAJ,CAAS,KAAT,CAAP;AARF;;AAWA,UAAO,KAAK,QAAL,CAAc,KAAd,CAAP;AACA;;;yCAGsB,K,EAAO;AAC7B,OAAI,SAAS,IAAb,EAAmB,OAAO,KAAP;;AAEnB,WAAQ,KAAK,IAAb;AACC,SAAK,MAAL;AACC,YAAO,KAAP;AACD,SAAK,MAAL;AACC,YAAO,KAAP;AACD,SAAK,OAAL;AACC,YAAO,KAAP;AACD,SAAK,IAAL;AACC,YAAO,MAAM,OAAN,EAAP;AARF;;AAWA,UAAO,MAAM,MAAN,EAAP;AACA;;;;;;kBArGmB,S","file":"field-type.js","sourcesContent":["import Field from './field'\r\n\r\n\r\nexport default class FieldType extends Field {\r\n\r\n\r\n\tconstructor(basePath, path, type, options, internal = false) {\r\n\t\tsuper(basePath, path, options, internal)\r\n\t\tthis.type = type\r\n\t\tthis.checkType(type)\r\n\t}\r\n\r\n\r\n\tcheckType(type) {\r\n\t\tif (type === Boolean) return\r\n\t\tif (type === String) return\r\n\t\tif (type === Number) return\r\n\t\tif (type === Date) return\r\n\r\n\t\tif (!type.prototype.toJSON) {\r\n\t\t\tthrow Error(`Custom Type ${type.name} must have method toJSON()`)\r\n\t\t}\r\n\r\n\t\tif (!type.fromJSON) {\r\n\t\t\tthrow Error(`Custom Type ${type.name} must have static method 'fromJSON': ${type.name}.fromJSON(document)`)\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tvalidate(data, basePath) {\r\n\t\tif (this.internal) return\r\n\r\n\t\tlet value = this.getByPath(data)\r\n\t\tif (!this.validateValue(value, basePath)) {\r\n\t\t\tthis.typeError(this.type, value)\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tvalidateValue(value, basePath) {\r\n\t\tlet type = this.type\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase String:\r\n\t\t\t\treturn typeof value === 'string'\r\n\t\t\tcase Number:\r\n\t\t\t\treturn this.validateNumber(value, basePath)\r\n\t\t\tcase Boolean:\r\n\t\t\t\treturn typeof value === 'boolean'\r\n\t\t\tdefault:\r\n\t\t\t\treturn value instanceof type\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tvalidateNumber(value, basePath) {\r\n\t\tif (typeof value !== 'number') return false\r\n\t\tlet options = this.options\r\n\r\n\r\n\t\tif ('min' in options) if (value < options.min) {\r\n\t\t\tconsole.log(111111111111111111111)\r\n\t\t\t// throw new ValidationRangeError([basePath, this.path], `RANGE`)\r\n\t\t}\r\n\t\t// if ('max' in options) if (value > options.max) return false\r\n\t\treturn true\r\n\t}\r\n\r\n\r\n\tconvertToModelValue(value) {\r\n\t\tif (value == null) return value\r\n\t\tlet type = this.type\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase String:\r\n\t\t\t\treturn String(value)\r\n\t\t\tcase Number:\r\n\t\t\t\treturn Number(value)\r\n\t\t\tcase Boolean:\r\n\t\t\t\treturn Boolean(value)\r\n\t\t\tcase Date:\r\n\t\t\t\treturn new Date(value)\r\n\t\t}\r\n\r\n\t\treturn type.fromJSON(value)\r\n\t}\r\n\r\n\r\n\tconvertToDocumentValue(value) {\r\n\t\tif (value == null) return value\r\n\r\n\t\tswitch (this.type) {\r\n\t\t\tcase String:\r\n\t\t\t\treturn value\r\n\t\t\tcase Number:\r\n\t\t\t\treturn value\r\n\t\t\tcase Boolean:\r\n\t\t\t\treturn value\r\n\t\t\tcase Date:\r\n\t\t\t\treturn value.getTime()\r\n\t\t}\r\n\r\n\t\treturn value.toJSON()\r\n\t}\r\n\r\n\r\n}\r\n\r\n\r\n\r\n"]}