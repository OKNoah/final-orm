{"version":3,"sources":["field-type.es6"],"names":[],"mappings":";;;;;;;;;AAAA;;;;AACA;;;;;;;;;;;;IAGqB,S;;;AAGpB,oBAAY,IAAZ,EAAkB,IAAlB,EAA0C;AAAA,MAAlB,QAAkB,yDAAP,KAAO;;AAAA;;AAAA,2FACnC,IADmC,EAC7B,QAD6B;;AAEzC,QAAK,IAAL,GAAY,IAAZ;AACA,QAAK,SAAL,CAAe,IAAf;AAHyC;AAIzC;;;;4BAGS,I,EAAM;AACf,OAAI,SAAS,OAAb,EAAsB;AACtB,OAAI,SAAS,MAAb,EAAqB;AACrB,OAAI,SAAS,MAAb,EAAqB;AACrB,OAAI,SAAS,IAAb,EAAmB;;AAEnB,OAAI,CAAC,KAAK,SAAL,CAAe,MAApB,EAA4B;AAC3B,UAAM,uBAAqB,KAAK,IAA1B,gCAAN;AACA;;AAED,OAAI,CAAC,KAAK,QAAV,EAAoB;AACnB,UAAM,uBAAqB,KAAK,IAA1B,+CAAsE,KAAK,IAA3E,yBAAN;AACA;AACD;;;2BAGQ,I,EAAM,Q,EAAU;AACxB,OAAI,KAAK,QAAT,EAAmB;;AAEnB,OAAI,QAAQ,KAAK,SAAL,CAAe,IAAf,CAAZ;AACA,OAAI,UAAU,KAAK,aAAL,CAAmB,KAAnB,CAAd;;AAEA,OAAI,CAAC,OAAL,EAAc;AACb,UAAM,8BAAoB,CAAC,QAAD,EAAW,KAAK,IAAhB,CAApB,EAA2C,KAAK,IAAhD,EAAsD,KAAtD,CAAN;AACA;AACD;;;gCAGa,K,EAAO;AACpB,OAAI,OAAO,KAAK,IAAhB;;AAEA,WAAQ,IAAR;AACC,SAAK,MAAL;AACC,YAAO,OAAO,KAAP,KAAiB,QAAxB;AACD,SAAK,MAAL;AACC,YAAO,OAAO,KAAP,KAAiB,QAAxB;AACD,SAAK,OAAL;AACC,YAAO,OAAO,KAAP,KAAiB,SAAxB;AACD;AACC,YAAO,iBAAiB,IAAxB;AARF;AAWA;;;sCAGmB,K,EAAO;AAC1B,OAAI,SAAS,IAAb,EAAmB,OAAO,KAAP;AACnB,OAAI,OAAO,KAAK,IAAhB;;AAEA,WAAQ,IAAR;AACC,SAAK,MAAL;AACC,YAAO,OAAO,KAAP,CAAP;AACD,SAAK,MAAL;AACC,YAAO,OAAO,KAAP,CAAP;AACD,SAAK,OAAL;AACC,YAAO,QAAQ,KAAR,CAAP;AACD,SAAK,IAAL;AACC,YAAO,IAAI,IAAJ,CAAS,KAAT,CAAP;AARF;;AAWA,UAAO,KAAK,QAAL,CAAc,KAAd,CAAP;AACA;;;yCAGsB,K,EAAO;AAC7B,OAAI,SAAS,IAAb,EAAmB,OAAO,KAAP;;AAEnB,WAAQ,KAAK,IAAb;AACC,SAAK,MAAL;AACC,YAAO,KAAP;AACD,SAAK,MAAL;AACC,YAAO,KAAP;AACD,SAAK,OAAL;AACC,YAAO,KAAP;AACD,SAAK,IAAL;AACC,YAAO,MAAM,OAAN,EAAP;AARF;;AAWA,UAAO,MAAM,MAAN,EAAP;AACA;;;;;;kBAzFmB,S","file":"field-type.js","sourcesContent":["import ValidationError from '../validation-error'\r\nimport Field from './field'\r\n\r\n\r\nexport default class FieldType extends Field {\r\n\r\n\r\n\tconstructor(path, type, internal = false) {\r\n\t\tsuper(path, internal)\r\n\t\tthis.type = type\r\n\t\tthis.checkType(type)\r\n\t}\r\n\r\n\r\n\tcheckType(type) {\r\n\t\tif (type === Boolean) return\r\n\t\tif (type === String) return\r\n\t\tif (type === Number) return\r\n\t\tif (type === Date) return\r\n\r\n\t\tif (!type.prototype.toJSON) {\r\n\t\t\tthrow Error(`Custom Type ${type.name} must have method toJSON()`)\r\n\t\t}\r\n\r\n\t\tif (!type.fromJSON) {\r\n\t\t\tthrow Error(`Custom Type ${type.name} must have static method 'fromJSON': ${type.name}.fromJSON(document)`)\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tvalidate(data, basePath) {\r\n\t\tif (this.internal) return\r\n\r\n\t\tlet value = this.getByPath(data)\r\n\t\tlet isValid = this.validateValue(value)\r\n\r\n\t\tif (!isValid) {\r\n\t\t\tthrow new ValidationError([basePath, this.path], this.type, value)\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tvalidateValue(value) {\r\n\t\tlet type = this.type\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase String:\r\n\t\t\t\treturn typeof value === 'string'\r\n\t\t\tcase Number:\r\n\t\t\t\treturn typeof value === 'number'\r\n\t\t\tcase Boolean:\r\n\t\t\t\treturn typeof value === 'boolean'\r\n\t\t\tdefault:\r\n\t\t\t\treturn value instanceof type\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tconvertToModelValue(value) {\r\n\t\tif (value == null) return value\r\n\t\tlet type = this.type\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase String:\r\n\t\t\t\treturn String(value)\r\n\t\t\tcase Number:\r\n\t\t\t\treturn Number(value)\r\n\t\t\tcase Boolean:\r\n\t\t\t\treturn Boolean(value)\r\n\t\t\tcase Date:\r\n\t\t\t\treturn new Date(value)\r\n\t\t}\r\n\r\n\t\treturn type.fromJSON(value)\r\n\t}\r\n\r\n\r\n\tconvertToDocumentValue(value) {\r\n\t\tif (value == null) return value\r\n\r\n\t\tswitch (this.type) {\r\n\t\t\tcase String:\r\n\t\t\t\treturn value\r\n\t\t\tcase Number:\r\n\t\t\t\treturn value\r\n\t\t\tcase Boolean:\r\n\t\t\t\treturn value\r\n\t\t\tcase Date:\r\n\t\t\t\treturn value.getTime()\r\n\t\t}\r\n\r\n\t\treturn value.toJSON()\r\n\t}\r\n\r\n\r\n}\r\n\r\n\r\n\r\n"]}